## 流水线

流水线技术把一个任务分解为若干顺序执行的子任务，不同的子任务由不同的执行机构负责执行，而这些机构可以同时并行工作。在任一时刻，任一任务只占用其中一个执行机构，这样就可以实现多个任务的重叠执行，以提高工作效率。

###  流水线周期

流水线应用过程中，会将需要处理的工作分为 N 个阶段，最耗时的那一段所消耗的时间为**流水线周期**。如：使用流水线技术执行 100 条指令，每条指令取指 2ms，分析 4ms，执行 1ms，则流水线周期为 4ms。

### 计算流水线执行时间

T: 流水线周期

N: 任务的阶段数量

n: 代表需要处理的任务数量。

```
# 理论公式
流水线执行时间 = 第 1 条指令的执行时间 +（n- 1） * T

# 实际公式
流水线执行时间 = NT +（n- 1） * T

```

考试时 80%以上的概率采用理论公式计算，所以考试时需要以理论
公式计算，若计算的结果无正确选项才考虑采用实际公式计算。



### 流水线的吞吐率

流水线的吞吐率（Though Put rate， TP）是指在单位时间内流水线所完成的任务数量或输出的结果数量。有些文献也称为平均吞吐率、实际吞吐率。计算流水线吞吐率的最基本的公式如下：

### 流水线的加速比

在流水线中，因为在同一时刻，有多个任务在重叠地执行，虽然完成一个任务的时间与
单独执行该任务相近（甚至由于分段的缘故，可能更多一些），但是从整体上看完成多个任
务所需的时间则大大减少。
完成同样一批任务，不使用流水线所用的时间与使用流水线所用的时间之比称为流水线
的加速比（speedup ratio）。如果不使用流水线，即顺序执行所用的时间为 T0 ，使用流水
线的执行时间为 Tk ，则计算流水线加速比的基本公式如下：
如果流水线各个流水段的执行时间都相等（设为 Dt），则一条 k 段流水线完成 n 个连 续
任务所需要的时间为(k+n-1)Dt。如果不使用流水线，即顺序执行这 n 个任务，则所需要的时
间为 nkDt。因此，各个流水段执行时间均相等的一条 k 段流水线完成 n 个连续任务 时的实
际加速比为：

